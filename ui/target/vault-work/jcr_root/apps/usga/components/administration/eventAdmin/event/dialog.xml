<?xml version="1.0" encoding="UTF-8"?>
<jcr:root xmlns:cq="http://www.day.com/jcr/cq/1.0" xmlns:jcr="http://www.jcp.org/jcr/1.0"
          jcr:primaryType="cq:Dialog"
          width="800"
          height="900"
          xtype="dialog">
    <items jcr:primaryType="cq:WidgetCollection">
        <tab
                jcr:primaryType="cq:Widget"
                hideMode="offsets"
                xtype="panel">
            <items jcr:primaryType="cq:WidgetCollection">
                <eventName
                        jcr:primaryType="cq:Widget"
                        fieldLabel="Event Name"
                        name="./name"
                        allowBlank="{Boolean}false"
                        xtype="textfield"/>
                <isChampionship
                        jcr:primaryType="cq:Widget"
                        fieldLabel="Is Championship Event?"
                        name="./isChampionship"
                        xtype="selection"
                        type="checkbox"/>
                <championshipType
                        jcr:primaryType="cq:Widget"
                        fieldLabel="Championship Type"
                        name="./championshipType"
                        type="select"
                        xtype="selection">
                    <options jcr:primaryType="cq:WidgetCollection">
                        <fourball
                                jcr:primaryType="nt:unstructured"
                                text="Fourball Championship"
                                value="fourball"/>
                        <open
                                jcr:primaryType="nt:unstructured"
                                text="Open Championship"
                                value="open"/>
                        <amateur
                                jcr:primaryType="nt:unstructured"
                                text="Amateur Championship"
                                value="amateur"/>
                        <state
                                jcr:primaryType="nt:unstructured"
                                text="State Team Championship"
                                value="state"/>
                        <cup
                                jcr:primaryType="nt:unstructured"
                                text="Cup Event"
                                value="cup"/>
                    </options>
                </championshipType>
                <isLeaderboards
                        jcr:primaryType="cq:Widget"
                        fieldLabel="Does this event have leaderboards?"
                        name="./isLeaderboards"
                        xtype="selection"
                        type="checkbox"/>
                <folderName
                        jcr:primaryType="cq:Widget"
                        fieldLabel="Data Folder Name for Leaderboards"
                        name="./dataFolderName"
                        xtype="textfield"/>
                <miniLeaderboardFeedPath
                        jcr:primaryType="cq:Widget"
                        fieldLabel="Mini Leader board Feed Path"
                        name="./miniLeaderboardFeedPath"
                        xtype="textfield"/>
                <miniLeaderboardTeeTimesFeedPath
                        jcr:primaryType="cq:Widget"
                        fieldLabel="Mini Leader board Tee Times Feed Path"
                        name="./miniLeaderboardTeeTimesFeedPath"
                        xtype="textfield"/>
                <rolexSrc
                        jcr:primaryType="cq:Widget"
                        fieldLabel="Rolex iframe src"
                        name="./rolexSrc"
                        xtype="textfield"/>
                <oneDayEvent
                        jcr:primaryType="cq:Widget"
                        fieldLabel="One day event"
                        name="./oneDayEvent"
                        xtype="selection"
                        type="checkbox">
                    <listeners
                            jcr:primaryType="nt:unstructured"
                            selectionchanged="function(component,value,checked) {
                        var startDate, endDate;

                        component.ownerCt.findByType('datetime').forEach(function(entry){
                            if(entry.name == './endDate') {
                                endDate = entry;
                            } else if(entry.name == './startDate') {
                                startDate = entry;
                            }
                        });

                        if(checked) {
                            endDate.disable();
                            var endDateValue = new Date(startDate.getValue().setHours(23,59,59,999));
                            endDate.setValue(endDateValue.toISOString());
                        } else {
                            endDate.reset();
                            endDate.enable();
                        }
                    }"
                            loadcontent="function(component,value) {
                        var startDate, endDate;

                        component.ownerCt.findByType('datetime').forEach(function(entry){
                            if(entry.name == './endDate') {
                                endDate = entry;
                            } else if(entry.name == './startDate') {
                                startDate = entry;
                            }
                        });

                        if(component.getValue()[0]) {
                            endDate.disable();
                            var endDateValue = new Date(startDate.getValue().setHours(23,59,59,999));
                            endDate.setValue(endDateValue.toISOString());
                        } else {
                            endDate.reset();
                            endDate.enable();
                        }
                    }"/>
                </oneDayEvent>
                <startDate
                        jcr:primaryType="cq:Widget"
                        fieldLabel="Event Start Date"
                        allowBlank="{Boolean}false"
                        name="./startDate"
                        xtype="datetime">
                    <listeners
                            jcr:primaryType="nt:unstructured"
                            change="function(component,newValue,oldValue) {
                        var oneDayEvent = false;

                        component.ownerCt.findByType('selection').forEach(function(entry){
                            if(entry.name == './oneDayEvent') {
                                oneDayEvent = entry.getValue()[0];
                            }
                        });

                        if(oneDayEvent) {
                            component.ownerCt.findByType('datetime').forEach(function(entry){
                                if(entry.name == './endDate') {
                                    if(newValue) {
                                        entry.setValue(new Date(newValue.setHours(23,59,59,999)).toISOString());
                                    } else {
                                        entry.reset();
                                    }
                                }
                            });
                        }
                    }"/>
                </startDate>
                <endDate
                        jcr:primaryType="cq:Widget"
                        fieldLabel="Event End Date"
                        allowBlank="{Boolean}false"
                        name="./endDate"
                        xtype="datetime"/>

                <tickerStartDate
                        jcr:primaryType="cq:Widget"
                        fieldLabel="Ticker Start Date"
                        name="./tickerStartDate"
                        xtype="datetime">
                </tickerStartDate>
                <tickerEndDate
                        jcr:primaryType="cq:Widget"
                        fieldLabel="Ticker End Date"
                        name="./tickerEndDate"
                        xtype="datetime"/>
                <logo
                        jcr:primaryType="cq:Widget"
                        defaultValue=""
                        fieldLabel="Logo"
                        name="./logo"
                        rootPath="/content/dam/usga"
                        xtype="pathfield"/>
                <eventUrl
                        jcr:primaryType="cq:Widget"
                        fieldLabel="Event URL"
                        name="./eventUrl"
                        xtype="textfield"/>
                <openEventUrlInNewWindow
                        jcr:primaryType="cq:Widget"
                        defaultValue="false"
                        checkboxBoolTypeHint="{Boolean}true"
                        fieldLabel="Open In New Window: "
                        name="./openEventUrlInNewWindow"
                        type="checkbox"
                        xtype="selection"/>
                <iconEnable
                        jcr:primaryType="cq:Widget"
                        collapsed="{Boolean}false"
                        collapsible="{Boolean}false"
                        title="Enabled Icons"
                        name="./iconEnablePanel"
                        xtype="dialogfieldset">
                    <items jcr:primaryType="cq:WidgetCollection">
                        <!-- add checkboxes here -->
                        <resultsEnable
                                jcr:primaryType="cq:Widget"
                                fieldDescription="enable Results URL/Path and icon"
                                fieldLabel="Results URL/Path and icon"
                                name="./resultsEnable"
                                xtype="selection"
                                type="checkbox">
                            <listeners
                                    jcr:primaryType="nt:unstructured"
                                    selectionchanged="function(component,value,checked) {
                                if(editFuncs.eventIconEnableAmountValidate(component)) {
                                    editFuncs.eventElementToggle(component.ownerCt.ownerCt.findByType('pathfield'), ['./resultsUrl'], checked);

                                    editFuncs.eventSetSmallIconOptions(component);
                                }
                            }"
                                    loadcontent="function(component,value) {
                                editFuncs.addMetaData(this, 'option-value','results');
                                editFuncs.addMetaData(this, 'option-text','Results');

                                editFuncs.eventSetSmallIconOptions(component);

                                editFuncs.eventElementToggle(component.ownerCt.ownerCt.findByType('pathfield'), ['./resultsUrl'], component.getValue()[0]);
                            }"/>
                        </resultsEnable>
                        <ticketsEnable
                                jcr:primaryType="cq:Widget"
                                fieldDescription="enable Tickets URL/Path and icon"
                                fieldLabel="Tickets URL/Path and icon"
                                name="./ticketsEnable"
                                xtype="selection"
                                type="checkbox">
                            <listeners
                                    jcr:primaryType="nt:unstructured"
                                    selectionchanged="function(component,value,checked) {
                                if(editFuncs.eventIconEnableAmountValidate(component)) {
                                    editFuncs.eventElementToggle(component.ownerCt.ownerCt.findByType('pathfield'), ['./ticketsUrl'], checked);

                                    editFuncs.eventSetSmallIconOptions(component);
                                }
                            }"
                                    loadcontent="function(component,value) {
                                editFuncs.addMetaData(this, 'option-value','tickets');
                                editFuncs.addMetaData(this, 'option-text','Tickets');

                                editFuncs.eventSetSmallIconOptions(component);

                                editFuncs.eventElementToggle(component.ownerCt.ownerCt.findByType('pathfield'), ['./ticketsUrl'], component.getValue()[0]);
                            }"/>
                        </ticketsEnable>
                        <volunteersEnable
                                jcr:primaryType="cq:Widget"
                                fieldDescription="enable Volunteers URL/Path and icon"
                                fieldLabel="Volunteers URL/Path and icon"
                                name="./volunteersEnable"
                                xtype="selection"
                                type="checkbox">
                            <listeners
                                    jcr:primaryType="nt:unstructured"
                                    selectionchanged="function(component,value,checked) {
                                if(editFuncs.eventIconEnableAmountValidate(component)) {
                                    editFuncs.eventElementToggle(component.ownerCt.ownerCt.findByType('pathfield'), ['./volunteersUrl'], checked);
                                    editFuncs.eventSetSmallIconOptions(component);
                                }
                            }"
                                    loadcontent="function(component,value) {
                                editFuncs.addMetaData(this, 'option-value','volunteer');
                                editFuncs.addMetaData(this, 'option-text','Volunteers');

                                editFuncs.eventSetSmallIconOptions(component);

                                editFuncs.eventElementToggle(component.ownerCt.ownerCt.findByType('pathfield'), ['./volunteersUrl'], component.getValue()[0]);
                            }"/>
                        </volunteersEnable>

                        <hospitalityEnable
                                jcr:primaryType="cq:Widget"
                                fieldDescription="enable Hospitality URL/Path and icon"
                                fieldLabel="Hospitality URL/Path and icon"
                                name="./hospitalityEnable"
                                xtype="selection"
                                type="checkbox">
                            <listeners
                                    jcr:primaryType="nt:unstructured"
                                    selectionchanged="function(component,value,checked) {
                                if(editFuncs.eventIconEnableAmountValidate(component)) {
                                    editFuncs.eventElementToggle(component.ownerCt.ownerCt.findByType('pathfield'), ['./hospitalityUrl'], checked);
                                    editFuncs.eventSetSmallIconOptions(component);
                                }
                            }"
                                    loadcontent="function(component,value) {
                                editFuncs.addMetaData(this, 'option-value','hospitality');
                                editFuncs.addMetaData(this, 'option-text','Hospitality');

                                editFuncs.eventSetSmallIconOptions(component);

                                editFuncs.eventElementToggle(component.ownerCt.ownerCt.findByType('pathfield'), ['./hospitalityUrl'], component.getValue()[0]);
                            }"/>

                        </hospitalityEnable>

                        <tvScheduleEnable
                                jcr:primaryType="cq:Widget"
                                fieldDescription="enable TV Schedule URL/Path and icon"
                                fieldLabel="TV Schedule URL/Path and icon"
                                name="./tvScheduleEnable"
                                xtype="selection"
                                type="checkbox">
                            <listeners
                                    jcr:primaryType="nt:unstructured"
                                    selectionchanged="function(component,value,checked) {
                                if(editFuncs.eventIconEnableAmountValidate(component)) {
                                    editFuncs.eventElementToggle(component.ownerCt.ownerCt.findByType('pathfield'), ['./tvScheduleUrl'], checked);
                                    editFuncs.eventSetSmallIconOptions(component);
                                }
                            }"
                                    loadcontent="function(component,value) {
                                editFuncs.addMetaData(this, 'option-value','tvSchedule');
                                editFuncs.addMetaData(this, 'option-text','TV Schedule');

                                editFuncs.eventSetSmallIconOptions(component);

                                editFuncs.eventElementToggle(component.ownerCt.ownerCt.findByType('pathfield'), ['./tvScheduleUrl'], component.getValue()[0]);
                            }"/>
                        </tvScheduleEnable>

                        <spectatorsEnable
                                jcr:primaryType="cq:Widget"
                                fieldDescription="spectators URL/Path and icon"
                                fieldLabel="Spectators URL/Path and icon"
                                name="./spectatorsEnable"
                                xtype="selection"
                                type="checkbox">
                            <listeners
                                    jcr:primaryType="nt:unstructured"
                                    selectionchanged="function(component,value,checked) {
                                if(editFuncs.eventIconEnableAmountValidate(component)) {
                                    editFuncs.eventElementToggle(component.ownerCt.ownerCt.findByType('pathfield'), ['./spectatorsUrl'], checked);
                                    editFuncs.eventSetSmallIconOptions(component);
                                }
                            }"
                                    loadcontent="function(component,value) {
                                editFuncs.addMetaData(this, 'option-value','spectator');
                                editFuncs.addMetaData(this, 'option-text','Spectator Info');

                                editFuncs.eventSetSmallIconOptions(component);

                                editFuncs.eventElementToggle(component.ownerCt.ownerCt.findByType('pathfield'), ['./spectatorsUrl'], component.getValue()[0]);
                            }"/>
                        </spectatorsEnable>

                        <applyToPlayEnable
                                jcr:primaryType="cq:Widget"
                                fieldDescription="apply to play URL/Path and icon"
                                fieldLabel="Apply To Play URL/Path and icon"
                                name="./applyToPlayEnable"
                                xtype="selection"
                                type="checkbox">
                            <listeners
                                    jcr:primaryType="nt:unstructured"
                                    selectionchanged="function(component,value,checked) {
                                if(editFuncs.eventIconEnableAmountValidate(component)) {
                                    editFuncs.eventElementToggle(component.ownerCt.ownerCt.findByType('pathfield'), ['./applyToPlayUrl'], checked);
                                    editFuncs.eventSetSmallIconOptions(component);
                                }
                            }"
                                    loadcontent="function(component,value) {
                                editFuncs.addMetaData(this, 'option-value','applyToPlay');
                                editFuncs.addMetaData(this, 'option-text','Apply to play');

                                editFuncs.eventSetSmallIconOptions(component);

                                editFuncs.eventElementToggle(component.ownerCt.ownerCt.findByType('pathfield'), ['./applyToPlayUrl'], component.getValue()[0]);
                            }"/>
                        </applyToPlayEnable>

                        <newsAndScoringEnable
                                jcr:primaryType="cq:Widget"
                                fieldDescription="news and scoring URL/Path and icon"
                                fieldLabel="News And Scoring URL/Path and icon"
                                name="./newsAndScoringEnable"
                                xtype="selection"
                                type="checkbox">
                            <listeners
                                    jcr:primaryType="nt:unstructured"
                                    selectionchanged="function(component,value,checked) {
                                if(editFuncs.eventIconEnableAmountValidate(component)) {
                                    editFuncs.eventElementToggle(component.ownerCt.ownerCt.findByType('pathfield'), ['./newsAndScoringUrl'], checked);
                                    editFuncs.eventSetSmallIconOptions(component);
                                }
                            }"
                                    loadcontent="function(component,value) {
                                editFuncs.addMetaData(this, 'option-value','newsAndScoring');
                                editFuncs.addMetaData(this, 'option-text','News and scoring');

                                editFuncs.eventSetSmallIconOptions(component);

                                editFuncs.eventElementToggle(component.ownerCt.ownerCt.findByType('pathfield'), ['./newsAndScoringUrl'], component.getValue()[0]);
                            }"/>
                        </newsAndScoringEnable>

                        <suitesEnable
                                jcr:primaryType="cq:Widget"
                                fieldDescription="suites URL/Path and icon"
                                fieldLabel="Suites URL/Path and icon"
                                name="./suitesEnable"
                                xtype="selection"
                                type="checkbox">
                            <listeners
                                    jcr:primaryType="nt:unstructured"
                                    selectionchanged="function(component,value,checked) {
                                if(editFuncs.eventIconEnableAmountValidate(component)) {
                                    editFuncs.eventElementToggle(component.ownerCt.ownerCt.findByType('pathfield'), ['./suitesUrl'], checked);
                                    editFuncs.eventSetSmallIconOptions(component);
                                }
                            }"
                                    loadcontent="function(component,value) {
                                editFuncs.addMetaData(this, 'option-value','suites');
                                editFuncs.addMetaData(this, 'option-text','Suites');

                                editFuncs.eventSetSmallIconOptions(component);

                                editFuncs.eventElementToggle(component.ownerCt.ownerCt.findByType('pathfield'), ['./suitesUrl'], component.getValue()[0]);
                            }"/>
                        </suitesEnable>
                    </items>
                </iconEnable>
                <urlsIcons
                        jcr:primaryType="cq:Widget"
                        collapsed="{Boolean}false"
                        collapsible="{Boolean}true"
                        title="URLs and Icons"
                        name="urlsIcons"
                        xtype="dialogfieldset">
                    <items jcr:primaryType="cq:WidgetCollection">
                        <resultsUrl
                                jcr:primaryType="cq:Widget"
                                defaultValue=""
                                fieldLabel="Results URL/Path"
                                name="./resultsUrl"
                                xtype="pathfield"/>
                        <ticketsUrl
                                jcr:primaryType="cq:Widget"
                                defaultValue=""
                                fieldLabel="Tickets URL/Path"
                                name="./ticketsUrl"
                                xtype="pathfield"/>
                        <volunteersUrl
                                jcr:primaryType="cq:Widget"
                                defaultValue=""
                                fieldLabel="Voluteering Url/Path"
                                name="./volunteersUrl"
                                xtype="pathfield"/>
                        <hospitalityUrl
                                jcr:primaryType="cq:Widget"
                                defaultValue=""
                                fieldLabel="Hospitality Url/Path"
                                name="./hospitalityUrl"
                                xtype="pathfield"/>
                        <tvScheduleUrl
                                jcr:primaryType="cq:Widget"
                                defaultValue=""
                                fieldLabel="TV Schedule Url/Path"
                                name="./tvScheduleUrl"
                                xtype="pathfield"/>
                        <spectatorsUrl
                                jcr:primaryType="cq:Widget"
                                defaultValue=""
                                fieldLabel="Spectators Url/Path"
                                name="./spectatorsUrl"
                                xtype="pathfield"/>
                        <applyToPlayUrl
                                jcr:primaryType="cq:Widget"
                                defaultValue=""
                                fieldLabel="Apply To Play Url/Path"
                                name="./applyToPlayUrl"
                                xtype="pathfield"/>
                        <newsAndScoringUrl
                                jcr:primaryType="cq:Widget"
                                defaultValue=""
                                fieldLabel="News And Scoring Url/Path"
                                name="./newsAndScoringUrl"
                                xtype="pathfield"/>
                        <suitesUrl
                                jcr:primaryType="cq:Widget"
                                defaultValue=""
                                fieldLabel="Suites Url/Path"
                                name="./suitesUrl"
                                xtype="pathfield"/>
                    </items>
                </urlsIcons>
                <smallBreakpointIcon
                        jcr:primaryType="cq:Widget"
                        allowBlank="{Boolean}true"
                        fieldLabel="Small Screen Icon"
                        fieldDescription="Icon that gets shown on small screens where there is only room for one.&lt;br/&gt; Enable at least one icon to select small screen one."
                        name="./smallBreakpointIcon"
                        xtype="selection"
                        type="select"/>
                <championshipPageImage
                        jcr:primaryType="cq:Widget"
                        fieldLabel="Championship Page Image"
                        defaultValue=""
                        name="./championshipPageImage"
                        rootPath="/content/dam/usga"
                        xtype="pathfield"/>
                <courseName
                        jcr:primaryType="cq:Widget"
                        fieldLabel="Course Name"
                        defaultValue=""
                        name="./courseName"
                        xtype="textfield"/>
                <courseImage
                        jcr:primaryType="cq:Widget"
                        fieldLabel="Course Image"
                        defaultValue=""
                        name="./courseImage"
                        rootPath="/content/dam/usga"
                        xtype="pathfield"/>
                <courseLocation
                        jcr:primaryType="cq:Widget"
                        fieldLabel="Course Location"
                        defaultValue=""
                        name="./courseLocation"
                        xtype="textfield"/>
                <buttonLabel
                        jcr:primaryType="cq:Widget"
                        fieldLabel="Carousel Championship Button Label: "
                        name="./buttonLabel"
                        width="300"
                        xtype="textfield"/>
                <ticketButtonLabel
                        jcr:primaryType="cq:Widget"
                        fieldLabel="Carousel Ticket Button Label: "
                        name="./ticketButtonLabel"
                        width="300"
                        xtype="textfield"/>
                <buttonLabelExpired
                        jcr:primaryType="cq:Widget"
                        fieldLabel="Carousel Button Label For Expired Event: "
                        name="./buttonLabelExpired"
                        width="300"
                        xtype="textfield"/>
                <buttonDestination
                        jcr:primaryType="cq:Widget"
                        fieldLabel="Carousel Championship Button Destination: "
                        name="./buttonDestination"
                        width="300"
                        xtype="pathfield"/>
                <ticketButtonDestination
                        jcr:primaryType="cq:Widget"
                        fieldLabel="Carousel Ticket Button Destination: "
                        name="./ticketButtonDestination"
                        width="300"
                        xtype="pathfield"/>
            </items>
        </tab>
    </items>
    <listeners
            jcr:primaryType="nt:unstructured"
            beforesubmit="function(dialog){
                dialog.findByType('datetime').forEach(function(entry){
                    if(entry.name == './endDate') {
                        entry.enable();
                    }
                });
            }"/>
</jcr:root>
